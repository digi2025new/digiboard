{% extends "base.html" %}
{% block content %}
<div class="public-page">
  <h2>{{ department | upper }} Notices - Slideshow</h2>
  
  <div class="slideshow-container">
    <div class="slideshow">
      {% for notice in notices %}
        <div class="slide">
          {% set file_url = url_for('uploaded_file', filename=notice[0]) %}
          {% if notice[1] in ['png', 'jpg', 'jpeg', 'gif'] %}
            <img src="{{ file_url }}" alt="Notice Image">
          {% elif notice[1] == 'mp4' %}
            <!-- Video now only shows controls; no autoplay or muted attributes -->
            <video src="{{ file_url }}" controls></video>
          {% elif notice[1] == 'mp3' %}
            <audio src="{{ file_url }}" controls></audio>
          {% else %}
            <!-- Documents now require a click; using download attribute -->
            <a href="{{ file_url }}" target="_blank" download>View Document</a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  let timer = 5000; // 5 seconds per slide
  let slides = document.querySelectorAll('.slideshow .slide');
  let currentSlide = 0;
  
  slides.forEach((slide, index) => {
    if (index !== 0) slide.style.display = 'none';
  });
  
  setInterval(() => {
    slides[currentSlide].style.display = 'none';
    currentSlide = (currentSlide + 1) % slides.length;
    slides[currentSlide].style.display = 'block';
  }, timer);
});
</script>
{% endblock %}
